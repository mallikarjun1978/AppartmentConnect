<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{residentMenu :: head}">    
</head>
<head>
    <script>
        function confirmBooking(facilityId) {
            // Show the confirmation pop-up
            if (confirm("Are you sure you want to book this facility?")) {
                // Submit the form
                document.getElementById('bookForm-' + facilityId).submit();
            }
        }
    </script>
</head>
<body>

    <!-- Include the navigation menu (residentMenu fragment) -->
    <div th:replace="~{residentMenu :: nav}"></div>

    <h2 class="mb-4">Available Facilities</h2>

    <!-- Success Message -->
    <div th:if="${message}" class="alert alert-success" role="alert">
        <span th:text="${message}"></span>
    </div>

    <table class="table table-bordered">
        <thead class="table-dark">
            <tr>
                <th>Facility ID</th>
                <th>Facility Name</th>
                <th>Description</th>
                <th>Available Time</th>
                <th>Max Capacity</th>
                <th>Is Active</th>
                <th>Created At</th>
                <th>Updated At</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="facility : ${facilities}">
                <td th:text="${facility.facilityId}"></td>
                <td th:text="${facility.facilityName}"></td>
                <td th:text="${facility.description}"></td>
                <td th:text="${facility.availableTime}"></td>
                <td th:text="${facility.maxCapacity}"></td>
                <td>
                    <span th:text="${facility.isActive ? 'Active' : 'Inactive'}"></span>
                </td>
                <td th:text="${facility.createdAt}"></td>
                <td th:text="${facility.updatedAt}"></td>
                <td>
                    <form th:id="'bookForm-' + ${facility.facilityId}" action="/front-end/facilitiesbooking/bookFacility" method="post">
                        <input type="hidden" name="facilityId" th:value="${facility.facilityId}" />
                        
                        <!-- Check if the facility is active, if not, disable the button -->
                        <button type="button" class="btn btn-primary" 
                            th:id="'bookButton-' + ${facility.facilityId}"
                            th:attr="onclick='confirmBooking(' + ${facility.facilityId} + ');'"
                            th:disabled="${!facility.isActive}">
                            Book
                        </button>
                    </form>
                </td>
            </tr>
        </tbody>
    </table>
	<div th:insert="~{residentMenu :: span}"></div>
</body>
</html>
